<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>From Power Up to Main: The Journey of Code Execution | What I Understood</title>
<meta name="keywords" content="">
<meta name="description" content="Assumptions I&rsquo;m assuming you have some basic knowledge of the compilation process and a little about linkers, you don&rsquo;t need to be an expert
Why Understanding Matters I&rsquo;m not a big fan of the idea that I can just press the green button and, boom, my code is somehow executing and being debugged on my MCU. I always like to understand what happens before I start using that IDE. In this article, you&rsquo;ll learn what goes on under the hood, and this knowledge can help you become independent from any IDE but also enable you to add custom frimware maybe your OS&hellip;">
<meta name="author" content="">
<link rel="canonical" href="https://gharbaoui.github.io/posts/from_powerup_to_main_a_jouney_of_code_execution/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.7f7383d596ad77eeb99f6259b4f0db45eaa4ca0ea48a082cbf85a1b397e649c9.css" integrity="sha256-f3OD1Zatd&#43;65n2JZtPDbReqkyg6kiggsv4Whs5fmSck=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://gharbaoui.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://gharbaoui.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://gharbaoui.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://gharbaoui.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://gharbaoui.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://gharbaoui.github.io/posts/from_powerup_to_main_a_jouney_of_code_execution/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>


  

<meta property="og:title" content="From Power Up to Main: The Journey of Code Execution" />
<meta property="og:description" content="Assumptions I&rsquo;m assuming you have some basic knowledge of the compilation process and a little about linkers, you don&rsquo;t need to be an expert
Why Understanding Matters I&rsquo;m not a big fan of the idea that I can just press the green button and, boom, my code is somehow executing and being debugged on my MCU. I always like to understand what happens before I start using that IDE. In this article, you&rsquo;ll learn what goes on under the hood, and this knowledge can help you become independent from any IDE but also enable you to add custom frimware maybe your OS&hellip;" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://gharbaoui.github.io/posts/from_powerup_to_main_a_jouney_of_code_execution/" />
<meta property="og:image" content="https://gharbaoui.github.io/from_boot_to_main/cover1" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-11-05T12:02:28+01:00" />
<meta property="article:modified_time" content="2024-11-05T12:02:28+01:00" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://gharbaoui.github.io/from_boot_to_main/cover1" />
<meta name="twitter:title" content="From Power Up to Main: The Journey of Code Execution"/>
<meta name="twitter:description" content="Assumptions I&rsquo;m assuming you have some basic knowledge of the compilation process and a little about linkers, you don&rsquo;t need to be an expert
Why Understanding Matters I&rsquo;m not a big fan of the idea that I can just press the green button and, boom, my code is somehow executing and being debugged on my MCU. I always like to understand what happens before I start using that IDE. In this article, you&rsquo;ll learn what goes on under the hood, and this knowledge can help you become independent from any IDE but also enable you to add custom frimware maybe your OS&hellip;"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://gharbaoui.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "From Power Up to Main: The Journey of Code Execution",
      "item": "https://gharbaoui.github.io/posts/from_powerup_to_main_a_jouney_of_code_execution/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "From Power Up to Main: The Journey of Code Execution",
  "name": "From Power Up to Main: The Journey of Code Execution",
  "description": "Assumptions I\u0026rsquo;m assuming you have some basic knowledge of the compilation process and a little about linkers, you don\u0026rsquo;t need to be an expert\nWhy Understanding Matters I\u0026rsquo;m not a big fan of the idea that I can just press the green button and, boom, my code is somehow executing and being debugged on my MCU. I always like to understand what happens before I start using that IDE. In this article, you\u0026rsquo;ll learn what goes on under the hood, and this knowledge can help you become independent from any IDE but also enable you to add custom frimware maybe your OS\u0026hellip;",
  "keywords": [
    
  ],
  "articleBody": "Assumptions I’m assuming you have some basic knowledge of the compilation process and a little about linkers, you don’t need to be an expert\nWhy Understanding Matters I’m not a big fan of the idea that I can just press the green button and, boom, my code is somehow executing and being debugged on my MCU. I always like to understand what happens before I start using that IDE. In this article, you’ll learn what goes on under the hood, and this knowledge can help you become independent from any IDE but also enable you to add custom frimware maybe your OS…\nCase Study: STM43F446RE I’m going to use the STM32F446RE as a demonstration, but the process is very similar, especially for other Cortex-M microcontrollers.\nBOOT Process Let’s answer the question of how this MCU boots. for example, if you are familiar with x86 architecture, you might know that there’s special location where the cpu “starts”, such as the MBR, and that there are operating modes like real mode and protected mode. if you’re not familiar with this. don’t worry, I’ll explain. Wait, What are ‘BOOT pins’? Well, typically, MCU manufactures provide jumpers that allow you to configure the boot options. This configuration is usually done using jumpers that look like these. let’s see if my MCU has them That’s still not very clear. Now I have Three questions:\nHow many pins should there be? Which values correspond to each mode? Most importantly, where are these pins located on the MCU so I can configure them? Or, if they’re hardwired, how can I determine which mode is set? Answers\nSince there are three modes, there should be at least two pins. here’s encoding of each mode I had a question about SYSCLK: Do I need to set something to select which oscillator to use? Well, as you can see, we don’t need to worry about it. here’s default value of BOOT0 With this knowledge, we understand that we are booting from flash memory.\nSo What? well first my code should be in flash, later we’ll look into the memory map for more info\nRESET If you’ve noticed, the term ‘reset vector’ appears frequently, which might suggest a connection to something called the vector table. Let’s take a closer look at it. What We Know So Far booting from flash At reset, the MCU loads the stack pointer (sp) from address 0x00000004 and sets the program counter (pc) to the reset vector, which is located at 0x00000004 vector table is located at 0x00000000 Memory Map I usually like to look at the memory map to get a sense of where everything is located. it really helps me when debugging at this level As you can see, flash memory is located at 0x08000000, so when constructing the ELF file, the vector table with the correct values should be placed there.\nThis is rough explanation at this point. I’ll blink the LED, but what matters is not what’s inside the ‘main’ function. I’m explaining how we reached that point.\nOkay, now let’s place the vector table at the start. Usually, when I need this level of control over where certain things should go, I create custom sections. This way, I can reference them later in the linker script.\nBy the way, I’m using the GNU toolchain, and here’s how you do it so let’s construct vector table, According to here’s what the source\nfocus only on these for now\nuint32_t vector_table[] __attribute__((section (\".cs_vectors\"))) = { (uint32_t)\u0026_start_of_sram, (uint32_t)reset_vector, ... } You might have questions about the other ‘attribute’—let me explain. Since I’m not focusing on other interrupts for now, I won’t implement them. Some of them are user-defined, so instead of implementing all of them, we’ll use\n__attribute__((weak, alias(\"blocking_handler\"))) to say that if this symbol is not defined, it will default to “blocking_handler”, here’s small demonstration:\n// test.c file int default_add(int a, int b) {return a + b;} int add(int, int) __attribute__((weak, alias(\"default_add\"))); int main() { return add(3, 2); } // add.c file int add(int a, int b) { return a + b + 34; } and if you have question about “_start_of_sram” that will come from linker script and if you have been following this far, you would know whatever the value of this “_start_of_sram”, will be stored in stack pointer so it should be at the end of sram since the stack is going “down”\nlet’s write a simple linker script look at PROVIDE(_start_of_sram = ORIGIN(sram) + LENGTH(sram)); This is the point where ‘_start_of_sram’ is set. Now, keep a close eye on this.\n\u003e sram AT \u003e flash What we’re saying here is that the virtual address will be in SRAM, while the logical address will be in flash. But Why? first of all, the .data section contains initialized global variables.\nuint32_t AAA = 90; // it will end up in the .data section uint32_t b; // in .bss section int main() { ... // something with variable AAA } So, ‘AAA = 90’ needs to be stored somewhere persistent, which is why we put it in flash memory since flash is non-volatile. At startup (inside reset_vector), we’ll copy it to SRAM. But why copy it to SRAM? we could update the value directly in flash, since we can write to flash during frimware updates. However, writing to flash is expensive in terms of time and resources. Additionally, during the lifetime of your program, the value will likely change. if we leave it in flash, those changes would be retained across power cycles, which is not desireable. By copy it to SRAM, we ensure that the value can be modified without affecting the flash storage, and it will reset to it’s default state on the next power-up. What ‘SRAM AT \u003e Flash’ means is that when writing the ELF file to the MCU, the .data section will be placed in flash. However, when referenced in the source code, it will appear as if it is in SRAM. Remember, in the reset vector, I’ll copy the .data section from flash to SRAM before handing control over to the main function. This way, everything works as expected for the user.\nas you can see that assembly of result is referencing SRAM area, and here’s if we did just \u003eflash As you can see, my code would be working directly with flash, which we don’t want. Now, we need to copy the .data section from flash to SRAM and then transfer control to the main function. To Copy something, we need three things: where to store it, where to read it from, and how much to copy. Okay let’s go back to the linker script\n... _start_of_text = .; ... _end_of_text = .; ... _start_of_data = .; ... _end_of_data = .; ... ... these are symbols that the linker will add them and we access them from our source files Here’s the source code for the copy operation.\nextern uint32_t _start_of_text; extern uint32_t _end_of_text; extern uint32_t _start_of_data; extern uint32_t _end_of_data; extern uint32_t _start_of_bss; extern uint32_t _end_of_bss; void reset_vector(void) { const uint32_t data_section_size = \u0026_end_of_data - \u0026_start_of_data; uint32_t* data_section_dst_on_sram_ptr = (uint32_t*)\u0026_start_of_data; const uint32_t* where_to_start_copy_from_ptr = (uint32_t*)\u0026_end_of_text; for (uint32_t i = 0; i \u003c data_section_size; ++i) { data_section_dst_on_sram_ptr[i] = where_to_start_copy_from_ptr[i]; } } I’m going to do the same for the .bss section.\nconst uint32_t bss_size = \u0026_end_of_bss - \u0026_start_of_bss; uint32_t* bss_dst = (uint32_t*)\u0026_start_of_bss; for (uint32_t i = 0; i \u003c bss_size; ++i) { bss_dst[i] = 0; } Now we’re ready to call “main”. By the way, I’ve decided to name it “system_start” instead.\nextern void\tsystem_start(void); void reset_vector(void) { const uint32_t data_section_size = \u0026_end_of_data - \u0026_start_of_data; uint32_t* data_section_dst_on_sram_ptr = (uint32_t*)\u0026_start_of_data; const uint32_t* where_to_start_copy_from_ptr = (uint32_t*)\u0026_end_of_text; for (uint32_t i = 0; i \u003c data_section_size; ++i) { data_section_dst_on_sram_ptr[i] = where_to_start_copy_from_ptr[i]; } const uint32_t bss_size = \u0026_end_of_bss - \u0026_start_of_bss; uint32_t* bss_dst = (uint32_t*)\u0026_start_of_bss; for (uint32_t i = 0; i \u003c bss_size; ++i) { bss_dst[i] = 0; } system_start(); } Let’s verify it using gdb. By the way, I’m using Segger J-Link, but you could also use an ST-Link on board or even GDB with OpenOCD. This is just my preference.\nAs you can see, it’s working. Now, I can put whatever I want there. let’s blink the builtin LED. Here’s the source code for it.\n#include #define GPIOA_ADDR 0x40020000 #define RCC_ADDR 0x40023800 #define RCC_AHB1 *(volatile uint32_t *)(RCC_ADDR + 0x30) #define GPIOA_ODR *(volatile uint32_t *)(GPIOA_ADDR + 0x14) #define GPIOA_MODER *(volatile uint32_t *)(GPIOA_ADDR + 0x00) #define GPIOA_OTYPER *(volatile uint32_t *)(GPIOA_ADDR + 0x04) #define GPIOA_OSPEEDER *(volatile uint32_t *)(GPIOA_ADDR + 0x08) #define PIN5_ON (1 \u003c\u003c 5) #define PIN5_OFF ~PIN5_ON void\tsystem_start(void) { RCC_AHB1 |= 0x01; // enable clock for ahb GPIOA_MODER |= (1 \u003c\u003c 10); // input or output // bad line GPIOA_OSPEEDER |= 0x00; // speed low GPIOA_OTYPER |= (0 \u003c\u003c 5); // probably will change push-pull drain while(1) { GPIOA_ODR |= PIN5_ON; for (int i = 0; i \u003c 500000; ++i); GPIOA_ODR \u0026= (PIN5_OFF); for (int i = 0; i \u003c 500000; ++i); } } I’m not going to explain this source code right now because this article isn’t about that. ",
  "wordCount" : "1510",
  "inLanguage": "en",
  "image":"https://gharbaoui.github.io/from_boot_to_main/cover1","datePublished": "2024-11-05T12:02:28+01:00",
  "dateModified": "2024-11-05T12:02:28+01:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://gharbaoui.github.io/posts/from_powerup_to_main_a_jouney_of_code_execution/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "What I Understood",
    "logo": {
      "@type": "ImageObject",
      "url": "https://gharbaoui.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://gharbaoui.github.io/" accesskey="h" title="What I Understood (Alt + H)">What I Understood</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://gharbaoui.github.io/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="https://gharbaoui.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://gharbaoui.github.io/">Home</a>&nbsp;»&nbsp;<a href="https://gharbaoui.github.io/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      From Power Up to Main: The Journey of Code Execution
    </h1>
    <div class="post-meta"><span title='2024-11-05 12:02:28 +0100 +01'>November 5, 2024</span>

</div>
  </header> 
<figure class="entry-cover"><a href="https://gharbaoui.github.io/from_boot_to_main/cover1" target="_blank"
            rel="noopener noreferrer"><img loading="eager" src="https://gharbaoui.github.io/from_boot_to_main/cover1" alt=""></a>
        
</figure>
  <div class="post-content"><h4 id="assumptions">Assumptions<a hidden class="anchor" aria-hidden="true" href="#assumptions">#</a></h4>
<p>I&rsquo;m assuming you have some basic knowledge of the compilation process and a little about linkers,
you don&rsquo;t need to be an expert</p>
<h3 id="why-understanding-matters">Why Understanding Matters<a hidden class="anchor" aria-hidden="true" href="#why-understanding-matters">#</a></h3>
<p>I&rsquo;m not a big fan of the idea that I can just press the green button and, boom, my code is somehow
executing and being debugged on my MCU. I always like to understand what happens before I start using
that IDE. In this article, you&rsquo;ll learn what goes on under the hood, and this knowledge can help you
become independent from any IDE but also enable you to add custom frimware maybe your OS&hellip;</p>
<h4 id="case-study-stm43f446re">Case Study: STM43F446RE<a hidden class="anchor" aria-hidden="true" href="#case-study-stm43f446re">#</a></h4>
<p>I&rsquo;m going to use the STM32F446RE as a demonstration, but the process is very similar, especially
for other Cortex-M microcontrollers.</p>
<h4 id="boot-process">BOOT Process<a hidden class="anchor" aria-hidden="true" href="#boot-process">#</a></h4>
<p>Let&rsquo;s answer the question of how this MCU boots. for example, if you are familiar with x86 architecture,
you might know that there&rsquo;s special location where the cpu &ldquo;starts&rdquo;, such as the MBR, and that there are
operating modes like real mode and protected mode. if you&rsquo;re not familiar with this. don&rsquo;t worry, I&rsquo;ll
explain.
<img loading="lazy" src="/from_boot_to_main/ds_boot_modes.png" alt=""  />
</p>
<p>Wait, What are &lsquo;BOOT pins&rsquo;? Well, typically, MCU manufactures provide jumpers that allow you to configure
the boot options. This configuration is usually done using jumpers that look like these.
<img loading="lazy" src="/from_boot_to_main/330px-Jumper_on_motherboard.jpg" alt=""  />

let&rsquo;s see if my MCU has them
<img loading="lazy" src="/from_boot_to_main/boot_pins_pic1.png" alt=""  />

<strong>That’s still not very clear. Now I have Three questions:</strong></p>
<ol>
<li>How many pins should there be?</li>
<li>Which values correspond to each mode?</li>
<li>Most importantly, where are these pins located on the MCU so I can configure them? Or, if they’re hardwired, how can I determine which mode is set?</li>
</ol>
<p><strong>Answers</strong></p>
<ol>
<li>Since there are three modes, there should be at least two pins.</li>
<li>here&rsquo;s encoding of each mode
<img loading="lazy" src="/from_boot_to_main/rf_boot_configuration.png" alt=""  />
</li>
</ol>
<p>I had a question about SYSCLK: Do I need to set something to select which oscillator to use?
Well, as you can see, we don&rsquo;t need to worry about it.
<img loading="lazy" src="/from_boot_to_main/sysclk1.png" alt=""  />

<img loading="lazy" src="/from_boot_to_main/sysclk2.png" alt=""  />
</p>
<ol start="3">
<li>here&rsquo;s default value of BOOT0
<img loading="lazy" src="/from_boot_to_main/boot1_p.png" alt=""  />

<img loading="lazy" src="/from_boot_to_main/boot2_p.png" alt=""  />

<img loading="lazy" src="/from_boot_to_main/boot3_p.png" alt=""  />
</li>
</ol>
<p>With this knowledge, we understand that we are booting from flash memory.</p>
<p><strong>So What?</strong>
well first my code should be in flash, later we&rsquo;ll look into the memory map for more info</p>
<h4 id="reset">RESET<a hidden class="anchor" aria-hidden="true" href="#reset">#</a></h4>
<p><img loading="lazy" src="/from_boot_to_main/pm_on_reset1.png" alt=""  />

<img loading="lazy" src="/from_boot_to_main/pm_on_reset2.png" alt=""  />

<img loading="lazy" src="/from_boot_to_main/rf_on_reset1.png" alt=""  />

<img loading="lazy" src="/from_boot_to_main/cpu_at.gif" alt=""  />
</p>
<p>If you&rsquo;ve noticed, the term &lsquo;reset vector&rsquo; appears frequently, which might suggest a connection to
something called the vector table. Let&rsquo;s take a closer look at it.
<img loading="lazy" src="/from_boot_to_main/vector_table.png" alt=""  />
</p>
<h4 id="what-we-know-so-far">What We Know So Far<a hidden class="anchor" aria-hidden="true" href="#what-we-know-so-far">#</a></h4>
<ul>
<li>booting from flash</li>
<li>At reset, the MCU loads the stack pointer (sp) from address 0x00000004 and sets the program counter (pc) to the <em>reset vector</em>, which is located at 0x00000004</li>
<li>vector table is located at 0x00000000</li>
</ul>
<h4 id="memory-map">Memory Map<a hidden class="anchor" aria-hidden="true" href="#memory-map">#</a></h4>
<p>I usually like to look at the memory map to get a sense of where everything is located.
it really helps me when debugging at this level
<img loading="lazy" src="/from_boot_to_main/memory_map.png" alt=""  />
</p>
<p>As you can see, flash memory is located at 0x08000000, so when constructing the ELF file, the vector
table with the correct values should be placed there.</p>
<p>This is rough explanation at this point.
<img loading="lazy" src="/from_boot_to_main/rough_idea_at_reset.png" alt=""  />
</p>
<p>I&rsquo;ll blink the LED, but what matters is not what&rsquo;s inside the &lsquo;main&rsquo; function. I&rsquo;m explaining how we
reached that point.</p>
<p>Okay, now let&rsquo;s place the vector table at the start. Usually, when I need this level of control over
where certain things should go, I create custom sections. This way, I can reference them later in the linker script.</p>
<p>By the way, I&rsquo;m using the GNU toolchain, and here&rsquo;s how you do it
<img loading="lazy" src="/from_boot_to_main/custom_sections1.png" alt=""  />

<img loading="lazy" src="/from_boot_to_main/custom_sections2.png" alt=""  />
</p>
<p>so let&rsquo;s construct vector table, According to
<img loading="lazy" src="/from_boot_to_main/vector_table_entries.png" alt=""  />
</p>
<p>here&rsquo;s what the <a href="https://github.com/Gharbaoui/from_power_up_to_main/blob/411b36d52b3d068e9289bd2849ce0b060111af62/startup.c">source</a></p>
<p>focus only on these for now</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">uint32_t</span> vector_table[] <span style="color:#a6e22e">__attribute__</span>((<span style="color:#a6e22e">section</span> (<span style="color:#e6db74">&#34;.cs_vectors&#34;</span>))) <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>  (<span style="color:#66d9ef">uint32_t</span>)<span style="color:#f92672">&amp;</span>_start_of_sram,
</span></span><span style="display:flex;"><span>  (<span style="color:#66d9ef">uint32_t</span>)reset_vector,
</span></span><span style="display:flex;"><span>  ...
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>You might have questions about the other &lsquo;attribute&rsquo;—let me explain. Since I’m not focusing on other
interrupts for now, I won’t implement them. Some of them are user-defined, so instead of implementing
all of them, we’ll use</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#a6e22e">__attribute__</span>((weak, <span style="color:#a6e22e">alias</span>(<span style="color:#e6db74">&#34;blocking_handler&#34;</span>)))
</span></span></code></pre></div><p>to say that if this symbol is not defined, it will default to &ldquo;blocking_handler&rdquo;, here&rsquo;s small demonstration:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#75715e">// test.c file
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">default_add</span>(<span style="color:#66d9ef">int</span> a, <span style="color:#66d9ef">int</span> b) {<span style="color:#66d9ef">return</span> a <span style="color:#f92672">+</span> b;}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">int</span>, <span style="color:#66d9ef">int</span>) <span style="color:#a6e22e">__attribute__</span>((weak, <span style="color:#a6e22e">alias</span>(<span style="color:#e6db74">&#34;default_add&#34;</span>)));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">add</span>(<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">2</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// add.c file
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">int</span> a, <span style="color:#66d9ef">int</span> b) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> a <span style="color:#f92672">+</span> b <span style="color:#f92672">+</span> <span style="color:#ae81ff">34</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><img loading="lazy" src="/from_boot_to_main/weak_alias_demo1.png" alt=""  />

<img loading="lazy" src="/from_boot_to_main/weak_alias_demo2.png" alt=""  />
</p>
<p>and if you have question about &ldquo;_start_of_sram&rdquo; that will come from linker script and if you have
been following this far, you would know whatever the value of this &ldquo;_start_of_sram&rdquo;, will be stored
in stack pointer so it should be at the end of sram since the stack is going &ldquo;down&rdquo;</p>
<p>let&rsquo;s write a simple linker script <a href="https://github.com/Gharbaoui/from_power_up_to_main/blob/42d723d49a15075c63fb2afe9f75e6768ab87f8f/linker_script.ld">look at</a>
<img loading="lazy" src="/from_boot_to_main/linker_sc_1.png" alt=""  />

<img loading="lazy" src="/from_boot_to_main/linker_sc_2.png" alt=""  />
</p>
<pre tabindex="0"><code class="language-ld" data-lang="ld">PROVIDE(_start_of_sram = ORIGIN(sram) + LENGTH(sram));
</code></pre><p>This is the point where &lsquo;_start_of_sram&rsquo; is set. Now, keep a close eye on this.</p>
<pre tabindex="0"><code class="language-ld" data-lang="ld">&gt; sram AT &gt; flash
</code></pre><p>What we’re saying here is that the virtual address will be in SRAM, while the logical address will be in flash.
<strong>But Why?</strong> first of all, the .data section contains initialized global variables.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">uint32_t</span> AAA <span style="color:#f92672">=</span> <span style="color:#ae81ff">90</span>; <span style="color:#75715e">// it will end up in the .data section
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">uint32_t</span> b; <span style="color:#75715e">// in .bss section
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// something with variable AAA
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre></div><p>So, &lsquo;AAA = 90&rsquo; needs to be stored somewhere persistent, which is why we put it in flash memory since flash
is non-volatile. At startup <em>(inside reset_vector)</em>, we&rsquo;ll copy it to SRAM. But why copy it to SRAM? we
could update the value directly in flash, since we can write to flash during frimware updates. However,
writing to flash is expensive in terms of time and resources. Additionally, during the lifetime of your program,
the value will likely change. if we leave it in flash, those changes would be retained across power
cycles, which is not desireable. By copy it to SRAM, we ensure that the value can be modified without affecting
the flash storage, and it will reset to it&rsquo;s default state on the next power-up.
What &lsquo;SRAM AT &gt; Flash&rsquo; means is that when writing the ELF file to the MCU, the .data section will be
placed in flash. However, when referenced in the source code, it will appear as if it is in SRAM.
Remember, in the reset vector, I&rsquo;ll copy the .data section from flash to SRAM before handing control
over to the main function. This way, everything works as expected for the user.</p>
<p><img loading="lazy" src="/from_boot_to_main/vma_lma_1.png" alt=""  />

<img loading="lazy" src="/from_boot_to_main/vma_lma_1_1.png" alt=""  />
</p>
<p>as you can see that assembly of result is referencing SRAM area, and here&rsquo;s if we did just <code>&gt;flash</code>
<img loading="lazy" src="/from_boot_to_main/vma_lma_2_2.png" alt=""  />
</p>
<p>As you can see, my code would be working directly with flash, which we don&rsquo;t want.
Now, we need to copy the .data section from flash to SRAM and then transfer control to the main function.
To Copy something, we need three things: where to store it, where to read it from, and how much to copy.
Okay let&rsquo;s go back to the linker script</p>
<pre tabindex="0"><code class="language-ld" data-lang="ld">...
_start_of_text = .;
...
_end_of_text = .;
...
_start_of_data = .;
...
_end_of_data = .;
...
...
</code></pre><p>these are symbols that the linker will add them and we access them from our source files
<img loading="lazy" src="/from_boot_to_main/linker_symbols_provided.png" alt=""  />

<img loading="lazy" src="/from_boot_to_main/startup_copy_sram.png" alt=""  />
</p>
<p>Here’s the source code for the copy operation.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">extern</span> <span style="color:#66d9ef">uint32_t</span> _start_of_text;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">extern</span> <span style="color:#66d9ef">uint32_t</span> _end_of_text;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">extern</span> <span style="color:#66d9ef">uint32_t</span> _start_of_data;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">extern</span> <span style="color:#66d9ef">uint32_t</span> _end_of_data;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">extern</span> <span style="color:#66d9ef">uint32_t</span> _start_of_bss;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">extern</span> <span style="color:#66d9ef">uint32_t</span> _end_of_bss;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">reset_vector</span>(<span style="color:#66d9ef">void</span>)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">uint32_t</span> data_section_size <span style="color:#f92672">=</span> <span style="color:#f92672">&amp;</span>_end_of_data <span style="color:#f92672">-</span> <span style="color:#f92672">&amp;</span>_start_of_data;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">uint32_t</span><span style="color:#f92672">*</span> data_section_dst_on_sram_ptr <span style="color:#f92672">=</span> (<span style="color:#66d9ef">uint32_t</span><span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>_start_of_data;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">uint32_t</span><span style="color:#f92672">*</span> where_to_start_copy_from_ptr <span style="color:#f92672">=</span> (<span style="color:#66d9ef">uint32_t</span><span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>_end_of_text;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">uint32_t</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> data_section_size; <span style="color:#f92672">++</span>i) {
</span></span><span style="display:flex;"><span>    data_section_dst_on_sram_ptr[i] <span style="color:#f92672">=</span> where_to_start_copy_from_ptr[i];
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>I’m going to do the same for the .bss section.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#66d9ef">uint32_t</span> bss_size <span style="color:#f92672">=</span> <span style="color:#f92672">&amp;</span>_end_of_bss <span style="color:#f92672">-</span> <span style="color:#f92672">&amp;</span>_start_of_bss;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">uint32_t</span><span style="color:#f92672">*</span> bss_dst <span style="color:#f92672">=</span> (<span style="color:#66d9ef">uint32_t</span><span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>_start_of_bss;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">uint32_t</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> bss_size; <span style="color:#f92672">++</span>i)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    bss_dst[i] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Now we&rsquo;re ready to call &ldquo;main&rdquo;. By the way, I’ve decided to name it &ldquo;system_start&rdquo; instead.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">extern</span> <span style="color:#66d9ef">void</span>	<span style="color:#a6e22e">system_start</span>(<span style="color:#66d9ef">void</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">reset_vector</span>(<span style="color:#66d9ef">void</span>)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">uint32_t</span> data_section_size <span style="color:#f92672">=</span> <span style="color:#f92672">&amp;</span>_end_of_data <span style="color:#f92672">-</span> <span style="color:#f92672">&amp;</span>_start_of_data;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">uint32_t</span><span style="color:#f92672">*</span> data_section_dst_on_sram_ptr <span style="color:#f92672">=</span> (<span style="color:#66d9ef">uint32_t</span><span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>_start_of_data;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">uint32_t</span><span style="color:#f92672">*</span> where_to_start_copy_from_ptr <span style="color:#f92672">=</span> (<span style="color:#66d9ef">uint32_t</span><span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>_end_of_text;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">uint32_t</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> data_section_size; <span style="color:#f92672">++</span>i) {
</span></span><span style="display:flex;"><span>    data_section_dst_on_sram_ptr[i] <span style="color:#f92672">=</span> where_to_start_copy_from_ptr[i];
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">uint32_t</span> bss_size <span style="color:#f92672">=</span> <span style="color:#f92672">&amp;</span>_end_of_bss <span style="color:#f92672">-</span> <span style="color:#f92672">&amp;</span>_start_of_bss;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">uint32_t</span><span style="color:#f92672">*</span> bss_dst <span style="color:#f92672">=</span> (<span style="color:#66d9ef">uint32_t</span><span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>_start_of_bss;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">uint32_t</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> bss_size; <span style="color:#f92672">++</span>i)
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    bss_dst[i] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">system_start</span>();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Let’s verify it using gdb. By the way, I’m using Segger J-Link, but you could also use an ST-Link on
board or even GDB with OpenOCD. This is just my preference.</p>
<p><img loading="lazy" src="/from_boot_to_main/db_1.png" alt=""  />

<img loading="lazy" src="/from_boot_to_main/db_2.png" alt=""  />

<img loading="lazy" src="/from_boot_to_main/db_3.png" alt=""  />
</p>
<p>As you can see, it&rsquo;s working. Now, I can put whatever I want there. let&rsquo;s blink the builtin LED.
Here&rsquo;s the source code for it.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdint.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#define GPIOA_ADDR 0x40020000
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#define RCC_ADDR 0x40023800
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#define RCC_AHB1 *(volatile uint32_t *)(RCC_ADDR + 0x30)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#define GPIOA_ODR *(volatile uint32_t *)(GPIOA_ADDR + 0x14)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#define GPIOA_MODER *(volatile uint32_t *)(GPIOA_ADDR + 0x00)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#define GPIOA_OTYPER *(volatile uint32_t *)(GPIOA_ADDR + 0x04)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#define GPIOA_OSPEEDER *(volatile uint32_t *)(GPIOA_ADDR + 0x08)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#define PIN5_ON (1 &lt;&lt; 5)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#define PIN5_OFF ~PIN5_ON
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span>	<span style="color:#a6e22e">system_start</span>(<span style="color:#66d9ef">void</span>)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	RCC_AHB1 <span style="color:#f92672">|=</span> <span style="color:#ae81ff">0x01</span>; <span style="color:#75715e">// enable clock for ahb
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	GPIOA_MODER <span style="color:#f92672">|=</span> (<span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">10</span>); <span style="color:#75715e">// input or output // bad line
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	GPIOA_OSPEEDER <span style="color:#f92672">|=</span> <span style="color:#ae81ff">0x00</span>; <span style="color:#75715e">// speed low
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	GPIOA_OTYPER <span style="color:#f92672">|=</span> (<span style="color:#ae81ff">0</span> <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">5</span>); <span style="color:#75715e">// probably will change push-pull drain
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">while</span>(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>	{
</span></span><span style="display:flex;"><span>		GPIOA_ODR <span style="color:#f92672">|=</span> PIN5_ON;
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">500000</span>; <span style="color:#f92672">++</span>i);
</span></span><span style="display:flex;"><span>		GPIOA_ODR <span style="color:#f92672">&amp;=</span> (PIN5_OFF);
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">500000</span>; <span style="color:#f92672">++</span>i);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>I’m not going to explain this source code right now because this article isn’t about that.
<img loading="lazy" src="/from_boot_to_main/demo.gif" alt=""  />
</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>

<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share From Power Up to Main: The Journey of Code Execution on x"
            href="https://x.com/intent/tweet/?text=From%20Power%20Up%20to%20Main%3a%20The%20Journey%20of%20Code%20Execution&amp;url=https%3a%2f%2fgharbaoui.github.io%2fposts%2ffrom_powerup_to_main_a_jouney_of_code_execution%2f&amp;hashtags=">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share From Power Up to Main: The Journey of Code Execution on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fgharbaoui.github.io%2fposts%2ffrom_powerup_to_main_a_jouney_of_code_execution%2f&amp;title=From%20Power%20Up%20to%20Main%3a%20The%20Journey%20of%20Code%20Execution&amp;summary=From%20Power%20Up%20to%20Main%3a%20The%20Journey%20of%20Code%20Execution&amp;source=https%3a%2f%2fgharbaoui.github.io%2fposts%2ffrom_powerup_to_main_a_jouney_of_code_execution%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share From Power Up to Main: The Journey of Code Execution on reddit"
            href="https://reddit.com/submit?url=https%3a%2f%2fgharbaoui.github.io%2fposts%2ffrom_powerup_to_main_a_jouney_of_code_execution%2f&title=From%20Power%20Up%20to%20Main%3a%20The%20Journey%20of%20Code%20Execution">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share From Power Up to Main: The Journey of Code Execution on facebook"
            href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fgharbaoui.github.io%2fposts%2ffrom_powerup_to_main_a_jouney_of_code_execution%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share From Power Up to Main: The Journey of Code Execution on whatsapp"
            href="https://api.whatsapp.com/send?text=From%20Power%20Up%20to%20Main%3a%20The%20Journey%20of%20Code%20Execution%20-%20https%3a%2f%2fgharbaoui.github.io%2fposts%2ffrom_powerup_to_main_a_jouney_of_code_execution%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share From Power Up to Main: The Journey of Code Execution on telegram"
            href="https://telegram.me/share/url?text=From%20Power%20Up%20to%20Main%3a%20The%20Journey%20of%20Code%20Execution&amp;url=https%3a%2f%2fgharbaoui.github.io%2fposts%2ffrom_powerup_to_main_a_jouney_of_code_execution%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share From Power Up to Main: The Journey of Code Execution on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=From%20Power%20Up%20to%20Main%3a%20The%20Journey%20of%20Code%20Execution&u=https%3a%2f%2fgharbaoui.github.io%2fposts%2ffrom_powerup_to_main_a_jouney_of_code_execution%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; Mohamed El Gharbaoui 2024.  This work is licensed under a <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a> <a href="https://gharbaoui.github.io/">What I Understood</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
